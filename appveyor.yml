image:
  - Visual Studio 2022

platform: x64

install:
  - ps: . {iwr -useb https://rakubrew.org/install-on-powershell.ps1 } | iex
  - ps: $Env:Path = "C:\rakubrew\bin;$Env:Path"
  - ps: $Env:Path = "$(rakubrew home)/shims;$Env:Path"
  - ps: rakubrew mode shim
  - ps: rakubrew download
  # git reports success to stderr on PowerShell, causing errors to be raised
  # hence redirect stderr to stdout.
  # See https://stackoverflow.com/a/47232450/10874800 and
  # https://stackoverflow.com/a/54624579/10874800 for more details.
  - ps: $env:GIT_REDIRECT_STDERR = '2>&1'
  - ps: rakubrew build zef
  - ps: zef --verbose --deps-only install .

build: off

test_script:
  - prove -v -e "raku -Ilib" t/

shallow_clone: true

  # cache:
  #   - 'C:\Strawberry'
